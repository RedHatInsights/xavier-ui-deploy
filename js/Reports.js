(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1094:function(e,t,n){"use strict";n.r(t);var r,a=n(72),o=n(2),i=n.n(o),l=n(591),s=n(458),c=n(252),u=n(265),p=n(266),d=n(259),f=n(260),m=n(268),h=n(270),g=n(130),v=n(269),S=n(302),b=n(273),R=n(263),E=n(221),D=n(129),y=n(287),T=n(286),w=n(482),P=n(705),F=n(704),x=(n(782),n(595)),N=n(209),C=n(213),A=n(214),I=n(208),O=n(472),_=n.n(O),k=n(630),B=n(455),j=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),L=function(){return(L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},M=5e3,Z=function(e){function t(t){var n=e.call(this,t)||this;return n.refreshDataWithDedounce=_()((function(){n.refreshData()}),800),n.setStateAndResetTimerAndSetRenderStatus=function(e){void 0===e&&(e={}),n.resetRefreshDataTimer(),n.setState(L({},e,{renderInProgresFetchStatus:!0}))},n.resetRefreshDataTimer=function(){n.stopTimer(),n.startTimer(n.refreshData)},n.startTimer=function(e){n.pullTimer&&clearInterval(n.pullTimer),n.pullTimer=setInterval(e,M)},n.stopTimer=function(){clearInterval(n.pullTimer)},n.refreshData=function(e,t,r){void 0===e&&(e=n.state.page),void 0===t&&(t=n.state.perPage),void 0===r&&(r=n.state.filterText),n.props.fetchReports(e,t,r).then((function(){n.filtersInRowsAndCells(),n.state.renderInProgresFetchStatus&&n.setState({renderInProgresFetchStatus:!1}),n.state.isFirstFetchReportsCall&&n.setState({isFirstFetchReportsCall:!1})}))},n.filtersInRowsAndCells=function(){var e=n.props.reports.items?Object.values(n.props.reports.items):[],t=[];e.length>0&&(t=e.map((function(e){return{cells:[{title:n.renderReportName(e)},{title:n.renderReportStatus(e)},{title:n.renderReportActions(e)}]}}))),n.setState({rows:t})},n.handleReportKebabToggle=function(e,t){var r=n.state.toggleReportsIDS,a=new Set(r);t?a.add(e.id):a.delete(e.id),n.setState({toggleReportsIDS:a},(function(){n.filtersInRowsAndCells()}))},n.handleDownloadReportPayload=function(e){var t=n.props,r=t.fetchReportPayloadDownloadLink,a=t.addNotification;n.handleReportKebabToggle(e,!1),r(e.id).then((function(e){if(!(e&&e.value&&e.value.data))throw new Error("No valid response found");var t=e.value.data;if(t.downloadLink){var n=document.createElement("a");n.href=t.downloadLink,n.setAttribute("download",t.filename),document.body.appendChild(n),n.click(),n.remove()}else a({variant:"danger",title:"Could not download payload file",description:"The retention period for the payload file has expired",dismissable:!0})}))},n.handleDeleteReport=function(e){var t=n.props,r=t.deleteReport,a=t.showDeleteDialog,o=t.closeDeleteDialog;a({name:e.reportName,type:"report",onDelete:function(){r(e.id,e.reportName).then((function(){o(),n.setStateAndResetTimerAndSetRenderStatus(),n.refreshData()}))},onCancel:function(){o()}})},n.onPageChange=function(e,t,r){n.setState({page:t}),n.setStateAndResetTimerAndSetRenderStatus(),r?n.refreshDataWithDedounce():n.refreshData(t)},n.onSetPage=function(e,t){return"pf-c-form-control"===e.target.className||n.onPageChange(e,t,!1)},n.onPageInput=function(e,t){return n.onPageChange(e,t,!0)},n.onPerPageSelect=function(e,t){n.setStateAndResetTimerAndSetRenderStatus({page:1,perPage:t}),n.refreshData(1,t)},n.handleSearchSubmit=function(e){var t=e.filterText.trim(),r=n.state.perPage;n.setStateAndResetTimerAndSetRenderStatus({filterText:t,page:1}),n.refreshData(1,r,t)},n.renderReportName=function(e){switch(e.status){case"CREATED":return i.a.createElement(l.a,{to:"/reports/"+e.id},e.reportName);default:return i.a.createElement("span",null,e.reportName)}},n.renderReportStatus=function(e){switch(e.status){case"CREATED":return i.a.createElement("p",null,i.a.createElement(N.b,{className:"success"})," Report created - ",Object(B.b)(new Date(e.lastUpdate)));case"FAILED":return i.a.createElement("p",null,i.a.createElement(C.b,{className:"error"})," Report failed - ",Object(B.b)(new Date(e.lastUpdate)));case"IN_PROGRESS":return i.a.createElement("p",null,i.a.createElement(A.b,{className:"progress"})," Analyzing the upload file");default:return null}},n.renderReportActions=function(e){var t=n.state.toggleReportsIDS.has(e.id),r=[i.a.createElement(c.a,{key:"download",component:"button",onClick:function(t){n.handleDownloadReportPayload(e)}},"Download"),i.a.createElement(c.a,{key:"delete",component:"button",onClick:function(t){n.handleDeleteReport(e)},style:{color:"var(--pf-global--danger-color--100)"}},"Delete")],a=i.a.createElement(u.a,{position:"right",toggle:i.a.createElement(p.a,{onToggle:function(t){n.handleReportKebabToggle(e,t)}}),isOpen:t,isPlain:!0,dropdownItems:r});switch(e.status){case"CREATED":case"FAILED":return a;case"IN_PROGRESS":return"";default:return null}},n.renderNoResults=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.a,null,i.a.createElement(f.a,null,i.a.createElement(m.a,{variant:m.b.full},i.a.createElement(h.a,{icon:I.b}),i.a.createElement(g.a,{headingLevel:"h5",size:"lg"},"No results found"),i.a.createElement(v.a,null,"No results match the search criteria")))))},n.renderResultsTable=function(){var e=n.state,t=e.rows,r=e.columns;return i.a.createElement(w.b,{"aria-label":"Reports list",rows:t,cells:r,gridBreakPoint:w.d.gridMd},i.a.createElement(P.a,null),i.a.createElement(F.a,null),i.a.createElement("tfoot",null,i.a.createElement("tr",null,i.a.createElement("td",{colSpan:10},n.renderPagination()))))},n.renderPagination=function(){var e=n.props.reports,t=n.state,r=t.page,a=t.perPage;return i.a.createElement(S.a,{itemCount:e.total,perPage:a,page:r,onSetPage:n.onSetPage,onPageInput:n.onPageInput,onPerPageSelect:n.onPerPageSelect})},n.renderResultsTableSkeleton=function(){return i.a.createElement(s.SkeletonTable,{colSize:3,rowSize:10})},n.renderSearchBox=function(){return i.a.createElement(k.a,{initialValues:{filterText:""},validate:function(){return{}},onSubmit:n.handleSearchSubmit},(function(e){var t=e.values,n=e.handleChange,r=e.handleBlur,a=e.handleSubmit;return i.a.createElement(b.a,{onSubmit:a},i.a.createElement(R.a,null,i.a.createElement(E.a,{type:"search",id:"filterText",name:"filterText","aria-label":"search text input",onChange:function(e,t){n(t)},onBlur:r,value:t.filterText,placeholder:"Filter by name..."}),i.a.createElement(D.a,{type:"submit",variant:D.c.tertiary,"aria-label":"search button for search input"},i.a.createElement(I.b,null))))}))},n.state={filterText:"",page:1,perPage:10,columns:["Name","Status",{title:"",props:{className:"pf-u-text-align-center"}}],rows:[],isFirstFetchReportsCall:!0,renderInProgresFetchStatus:!1,toggleReportsIDS:new Set},n}return j(t,e),t.prototype.componentDidMount=function(){this.refreshData(),this.resetRefreshDataTimer()},t.prototype.componentDidUpdate=function(){var e=this.props,t=e.reportsFetchStatus,n=e.reports,r=this.state.isFirstFetchReportsCall;0===n.total&&r&&"complete"===t.status&&this.props.history.push("/no-reports")},t.prototype.componentWillUnmount=function(){this.stopTimer()},t.prototype.render=function(){var e,t,n=this.state,r=n.isFirstFetchReportsCall,a=n.renderInProgresFetchStatus,o=this.props,c=o.reports,u=o.reportsFetchStatus;return e=r?"":i.a.createElement(s.TableToolbar,{className:"pf-u-justify-content-space-between"},i.a.createElement(y.a,null,i.a.createElement(T.a,{className:"pf-u-mr-xl"},this.renderSearchBox()),i.a.createElement(T.a,{className:"pf-u-mr-md"},i.a.createElement(l.a,{to:"/reports/upload",className:"pf-c-button pf-m-primary"},"Create"))),i.a.createElement(y.a,null,i.a.createElement(T.a,null,this.renderPagination()))),t=r||"inProgress"===u.status&&a?this.renderResultsTableSkeleton():c.total>0?this.renderResultsTable():this.renderNoResults(),i.a.createElement(x.a,null,e,t)},t}(i.a.Component),z=n(323),U=n(100),W=n(13),K=n(107),G={addNotification:U.addNotification,fetchReports:W.l,deleteReport:W.b,showDeleteDialog:K.c,closeDeleteDialog:K.a,fetchReportPayloadDownloadLink:W.f};t.default=Object(z.a)(Object(a.connect)((function(e){var t=e.reportState;return{reports:t.reports,reportsFetchStatus:t.reportsFetchStatus}}),G)(Z))},455:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return d}));var r=function(e){return e?e.toLowerCase():""},a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.fractionDigits,a=void 0===r?2:r,o=e;return e||(o=0),o.toLocaleString("en",{style:"currency",currency:t||"USD",minimumFractionDigits:a,maximumFractionDigits:a})},o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.fractionDigits;return e.toFixed(r)},i=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.fractionDigits,a=void 0===r?2:r;return e.toFixed(a)},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.fractionDigits;return e.toFixed(r)},s=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=r(t),c=e||0;switch(s){case"usd":return a(c,s,n);case"gb":case"gb-hours":case"gb-mo":return i(c,s,n);case"core-hours":case"hrs":return l(c,s,n);default:return o(c,s,n)}},c=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Intl.DateTimeFormat().resolvedOptions().timeZone,r={timeZone:n,timeZoneName:"short",year:"numeric",month:"long",day:"numeric"},a={timeZone:n,timeZoneName:"short",hour:"2-digit",minute:"2-digit"},o=r;return t&&(o=Object.assign({},r,a)),e.toLocaleDateString("en",o)},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toLocaleString("en",{style:"decimal",minimumFractionDigits:t,maximumFractionDigits:t})},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toLocaleString("en",{style:"percent",minimumFractionDigits:t,maximumFractionDigits:t})},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1024,r=t<0?0:t,a=["Bytes","KB","MB","GiB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(e)/Math.log(n)),i=parseFloat((e/Math.pow(n,o)).toFixed(r));return u(i,t)+" "+a[o]}},472:function(e,t,n){var r=n(457),a=n(517),o=n(485),i="Expected a function",l=Math.max,s=Math.min;e.exports=function(e,t,n){var c,u,p,d,f,m,h=0,g=!1,v=!1,S=!0;if("function"!=typeof e)throw new TypeError(i);function b(t){var n=c,r=u;return c=u=void 0,h=t,d=e.apply(r,n)}function R(e){var n=e-m;return void 0===m||n>=t||n<0||v&&e-h>=p}function E(){var e=a();if(R(e))return D(e);f=setTimeout(E,function(e){var n=t-(e-m);return v?s(n,p-(e-h)):n}(e))}function D(e){return f=void 0,S&&c?b(e):(c=u=void 0,d)}function y(){var e=a(),n=R(e);if(c=arguments,u=this,m=e,n){if(void 0===f)return function(e){return h=e,f=setTimeout(E,t),g?b(e):d}(m);if(v)return clearTimeout(f),f=setTimeout(E,t),b(m)}return void 0===f&&(f=setTimeout(E,t)),d}return t=o(t)||0,r(n)&&(g=!!n.leading,p=(v="maxWait"in n)?l(o(n.maxWait)||0,t):p,S="trailing"in n?!!n.trailing:S),y.cancel=function(){void 0!==f&&clearTimeout(f),h=0,c=m=u=f=void 0},y.flush=function(){return void 0===f?d:D(a())},y}},485:function(e,t){e.exports=function(e){return e}},515:function(e,t,n){"use strict";var r,a=n(2),o=n.n(a),i=n(458),l=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(t){return e.call(this,t)||this}return l(t,e),t.prototype.render=function(){var e=this.props.children;return o.a.createElement(a.Fragment,null,o.a.createElement(i.PageHeader,null,o.a.createElement(i.PageHeaderTitle,{title:"Reports"})),o.a.createElement(i.Main,{style:this.props.mainStyle},e))},t}(a.Component);t.a=s},517:function(e,t,n){var r=n(484);e.exports=function(){return r.Date.now()}},594:function(e,t,n){(e.exports=n(7)(!1)).push([e.i,".pf-c-empty-state > .dropzone {\n  margin-top: var(--pf-c-empty-state--c-button--MarginTop); }\n\n.error {\n  color: var(--pf-global--danger-color--100) !important; }\n\n.success {\n  color: var(--pf-global--success-color--100) !important; }\n",""])},595:function(e,t,n){"use strict";var r=n(515);t.a=r.a},782:function(e,t,n){var r=n(594);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0},o=n(8)(r,a);r.locals&&(e.exports=r.locals),e.hot.accept(594,(function(){var t=n(594);if("string"==typeof t&&(t=[[e.i,t,""]]),!function(e,t){var n,r=0;for(n in e){if(!t||e[n]!==t[n])return!1;r++}for(n in t)r--;return 0===r}(r.locals,t.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");o(t)})),e.hot.dispose((function(){o()}))}}]);
//# sourceMappingURL=Reports.js.map